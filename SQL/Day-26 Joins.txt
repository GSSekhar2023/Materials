24-04-2023
	JOINS
				---------

    
 =>  join is an operation performed to display data from two or more tables.

 => in DBs related data stored in multiple tables , to gather or to combine data
      stored in multiple tables  we need to join those tables.

 Example :- 

    orders                                                  customers
    ordid      orddt    deldt       cid                cid      name         addr
    1000      ??         ??         10                 10        A              HYD
    1001                                11                 11        B              HYD
     1002                               12                 12        C             HYD

   output :- 
 
    ordid    orddt    deldt     name    addr 
    1000    ??        ??        A           HYD

 Types of Joins :- 
 --------------------

 1  INNER JOIN / EQUI JOIN
 2  OUTER JOIN
        LEFT OUTER
        RIGHT OUTER
        FULL OUTER
 3  NON EQUI JOIN
 4  SELF JOIN
 5  CROSS / CARTESIAN JOIN

 INNER JOIN / EQUI JOIN :-  
 ------------------------------------

  =>  to perform inner join between the two tables there must be a common field and 
        name of the common field need not to be same and pk-fk relationship is not compulsory

  => inner join is performed based on the common field with same datatype.

       SELECT columns
       FROM  tab1  INNER JOIN tab2 
           ON   join condition 

 join condition :- 
 --------------------

=>  based on the given join condition sql server joins the records of two tables.
=>  join condition determines which record of 1st table joined with which record of 2nd table.

             table1.commonfield =  table2.commonfield

  
 Example :- 

 EMP					DEPT
 EMPNO	ENAME	SAL	DEPTNO		DEPTNO	DNAME		LOC
  1	A	5000	10		10	ACCOUNTS	NY	
  2	B	3000	20		20	RESEARCH		
  3	C	4000	30		30	SALES	
  4	D	3000	10		40	OPERATIONS	
  5	E	2000	NULL

  =>  display     ENAME      SAL       DNAME     LOC    ?
                        --------------------       ----------------------
                               EMP                    DEPT

        SELECT  ENAME,SAL,DNAME,LOC
            FROM EMP INNER JOIN DEPT
                ON  EMP.DEPTNO = DEPT.DEPTNO 

 => display    ENAME  SAL   DEPTNO   DNAME   LOC   ?

       SELECT  ENAME,SAL,
                      DEPTNO ,DNAME,LOC
            FROM EMP INNER JOIN DEPT
                ON  EMP.DEPTNO = DEPT.DEPTNO   => ERROR (ambiguity)

     NOTE :-  
 
      in join queries  declare table alias and prefix column names with table alias for two reasons

     1  to avoid ambiguity error
     2  for faster execution

    SELECT   E.ENAME,E.SAL,
                    D.DEPTNO ,D.DNAME,D.LOC
        FROM EMP AS E INNER JOIN DEPT AS D
             ON  E.DEPTNO = D.DEPTNO
      
    => display employees working at NEW YORK loc ?

         SELECT E.ENAME,D.DNAME,D.LOC
            FROM EMP AS E INNER JOIN DEPT AS  D 
                ON  E.DEPTNO = D.DEPTNO    /* join condition */
            WHERE D.LOC = 'NEW YORK'     /*  filter condition */

  joining more than 2 tables :- 
  --------------------------------------

  => if no of tables increases no of join conditions also increases. 
  => to join N tables N-1 join conditions required.

    SELECT  columns
       FROM  tab1 INNER JOIN tab2
            ON   join condition
                           INNER JOIN tab3
             ON  join condition
                           -------------------

 ex :- 
 
  EMP             DEPT               LOCATIONS            COUNTRIES
  empno          deptno              locid                         country_id
  ename          dname              city                           country_name
  sal                locid                  state                         
  deptno                                   country_id 
  
 => display    ENAME    DNAME     CITY    STATE    COUNTRY_NAME  ?
                     ----------    -----------     ------------------    --------------------------
                     EMP        DEPT         LOCATIONS        COUNTRIES

     SELECT   e.ename,
                     d.dname,      
                     l.city,l.state,
                     c.country_name as country
     FROM emp as e INNER JOIN dept as d
           ON e.deptno = d.deptno 
                                INNER JOIN locations as l
           ON d.locid  =  l.locid
                                INNER JOIN countries as c
           ON l.country_id = c.country_id 

 OUTER JOIN :- 
 ---------------------

=>  inner join returns only matching records but won't return unmatched records , 
      to display unmatched records perform outer join.

example :-

 EMP					DEPT
 EMPNO	ENAME	SAL	DEPTNO		DEPTNO	DNAME		LOC
  1	A	5000	10		10	ACCOUNTS	NY	
  2	B	3000	20		20	RESEARCH		
  3	C	4000	30		30	SALES	
  4	D	3000	10		40	OPERATIONS => unmatched row
  5	E	2000	NULL =>  unmatched row

 
 => outer join is 3 types 

   1  LEFT JOIN
   2  RIGHT JOIN
   3  FULL JOIN

   LEFT JOIN :- 
   ------------------

  =>  returns all rows from left side table and matching rows from right side table.

       SELECT  E.ENAME,D.DNAME
          FROM  EMP AS E  LEFT JOIN DEPT AS D
               ON  E.DEPTNO = D.DEPTNO

     => returns all rows from emp table and matching rows from dept table

       A	ACCOUNTS
       B	RESEARCH
       C	SALES
       D	ACCOUNTS
       E	NULL                => unmatched row from emp 

 RIGHT JOIN :- 
 ---------------------

  => returns all rows from right side table and matching rows from left side table

       SELECT  E.ENAME,D.DNAME
          FROM  EMP AS E  RIGHT JOIN DEPT AS D
               ON  E.DEPTNO = D.DEPTNO

  => returns all rows from dept table and matching rows from emp table

 	A	ACCOUNTS
	B	RESEARCH
	C	SALES
	D	ACCOUNTS
	NULL	OPERATIONS => unmatched from dept 
